---
title: "TSA Claims"
author: "Samba Diallo, David Jia, Raquel Figueroa"
date: "5/13/2018"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(prompt=TRUE, comment="", echo=TRUE)
dat = read.csv("https://raw.githubusercontent.com/RaquelFigueroa/tsa_claims/master/tsa_claims.csv")
```

## Project Introduction

For this project, we are investigating property and injury claims filed with the Terminal Security Agency (TSA). We hope to determine patterns and correlations between claims made at airports across the United States...[TODO]


## Project Data

The TSA claims dataset we are using is composed of 204,267 rows and 13 columns. There are many empty values so it will be assumed that many of the rows will be discarded depending on what sorts of features will be used for model creation and data exploration.

This dataset may be found at the link below:
https://www.kaggle.com/terminal-security-agency/tsa-claims-database/data


## Initial data exploration
It should be noted that running the complete.cases() function and counting the total number of complete rows showed that all rows are complete. This means that there are no `NA` values, but through the `summary()` function we can see that there are other values to be aware of. There are a notable number of empty string values, dashes ('-'), and the value `Other`. To avoid unintentionally skewing results, these values will need to be discarded or imputed.

```{r}
summary(dat)
```

Another helpful starting function is str():

Through this function, we can see that all features are factors.

We can also determine that there are 204267 rows of data and 13 features.
One interesting feature is `Claim.Number` as it would be assumed that there should be a unique number for each of the unique rows of data. There are 23 less unique claim numbers than there are rows. This could mean that some of the claims needed to be resubmitted and this should be investigated further to ensure some data is not counted twice.

The features are as follows:

* Continuous Features
    + Claim.Amount
    + Close.Amount
    
* Categorical Features
    + Claim.Number
    + Date.Received
    + Incident.Date
    + Airport.Code
    + Airport.Name
    + Airline.Name
    + Claim.Type
    + Claim.Site
    + Item
    + Status
    + Disposition

```{r}
str(dat)
```


```{r, echo=TRUE}
table(dat$Claim.Type)
```

## Data cleaning and preprocessing
From what we discovered during the initial data exploration section, we want to alter some of the values in certain columns to describe more cohesively what situations they are describing. 

There are some strange rows in the data so we first delete the errors from the data frame.
We also delete any row that have Date Received, Airport Name, or Claim Amount as empty strings.

```{r, echo=TRUE}
glitchRows = c(186743,97232,145145,186744,195600)
dat = dat[-glitchRows,]


dat$Claim.Amount = gsub(";","",dat$Claim.Amount)
dat$Claim.Amount = gsub("$","",dat$Claim.Amount)
dat$Claim.Amount = gsub(" ","",dat$Claim.Amount)

dat = dat[dat$Date.Received != "",]
dat = dat[dat$Airport.Name != "",]
dat = dat[dat$Claim.Amount != "" & dat$Claim.Amount != "-",]
```

We then want to remove all the empty strings and dashes and replace them with "N/A" 



####"N/A" Strings
```{r, echo=TRUE}
levels(dat$Status)[levels(dat$Status) %in% c('-','')] <- 'N/A'
levels(dat$Disposition)[levels(dat$Disposition) %in% c('')] <- 'N/A'
levels(dat$Close.Amount)[levels(dat$Close.Amount) %in% c('')] <- 'N/A'
levels(dat$Airport.Code)[levels(dat$Airport.Code) %in% c('-','')] <- 'N/A'
levels(dat$Claim.Type)[levels(dat$Claim.Type) %in% c('-','')] <- 'N/A'
levels(dat$Claim.Site)[levels(dat$Claim.Site) %in% c('-','')] <- 'N/A'

```




####Empty Strings
```{r, echo=TRUE}

```
        
#### '-' Strings
```{r, echo=TRUE}

apply(dat,2,function(x){
  levels(x)[levels(x) %in% c('-','', ' ')] <- 'N/A'
})


```



####"OTHER" Strings
```{r, echo=TRUE}

```

####"UNKNOWN" Strings
```{r, echo=TRUE}

```

## Data exploration and visualization

## Conclusions
